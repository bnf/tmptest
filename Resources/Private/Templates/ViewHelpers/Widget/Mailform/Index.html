{namespace qbtools=Qbus\Qbtools\ViewHelpers}
<script type="text/javascript">
jQuery(function() {
	$("#{qbmailformid}").submit(function(event) {
		event.preventDefault();
		$form = $(this);
		$('html, body').animate({
			scrollTop: $("#{qbmailformid}").offset().top
		}, 1000);
		jQuery.post($form.attr("action"), $form.serialize(), function(data) {
			if (data.status == "ok") {
				$(".qbtools-mailform-notification", $form).hide().html("Anfrage erfolgreich versendet").fadeIn("slow");
			} else if (data.status == "fields-missing") {
				$(".qbtools-mailform-notification", $form).hide()
					.html("Die Anfrage wurde nicht versendet.<br/>" +
					      "Die Felder " + data.missing.join(",") + " müssen ausgefüllt werden.").fadeIn("slow");
			}
		}, "json");
	});
});
</script>

<f:form actionUri="{f:widget.uri(action: 'mail', ajax: 1, includeWidgetContext: 1)}" method="post" fieldNamePrefix="msg"
		additionalParams="{role: 'form'}" id="{qbmailformid}" class="qbtools-mailform">
	<f:renderChildren arguments="{qbmailformid: qbmailformid}" />
</f:form>
